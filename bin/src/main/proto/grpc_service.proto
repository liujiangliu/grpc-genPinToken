syntax = "proto3";

package grpc_service;

option java_package = "com.example.grpc.grpc_service";
option java_outer_classname = "GrpcServiceProto";
option java_multiple_files = true;

service GrpcService {
  rpc GeneratePin (PinRequest) returns (PinResponse);
  rpc GenerateJwt (JwtRequest) returns (JwtResponse);
  rpc ValidateJwt (ValidateRequest) returns (ValidateResponse);
}

message PinRequest {
  int32 length = 1;
}

message PinResponse {
  string pin = 1;
}

message JwtRequest {
  string subject = 1;
  int64 expirationTime = 2;
}

message JwtResponse {
  string jwtToken = 1;
}

message ValidateRequest {
  string jwtToken = 1;
}

message ValidateResponse {
  bool isValid = 1;
  string subject = 2;
  int64 expirationTime = 3;
  string errorMessage = 4;
}